package ${packageName};

import android.app.Activity;
import android.text.Editable;
import android.text.TextWatcher;
import android.widget.EditText;

import utils.Observer;
import utils.State;
import java.lang.reflect.Field;

public class ${className}ViewBinding
{
     private EditText editText;

     public ${className}ViewBinding(Activity activity)
     {
        try
        {
            Field field = activity.getClass().getField("${value}");
            State<String> value = (State<String>) field.get(activity);

            editText = (EditText) activity.findViewById(${viewId});
            editText.setText(value.getValue());
            editText.addTextChangedListener(new EditTextBinder(value));
        }
        catch(NoSuchFieldException | IllegalAccessException e)
        {
            e.printStackTrace();
        }
     }

     public void observe(State<String> state)
     {
        state.observe(stringObserver);
     }

     public void unObserve(State<String> state)
     {
        state.unObserve(stringObserver);
     }

     public class EditTextBinder implements TextWatcher
     {
       private State<String> value;

       public EditTextBinder(State<String> value)
       {
         this.value = value;
       }

       @Override
       public void beforeTextChanged(CharSequence s, int start, int count, int after)
       {
       }

       @Override
       public void onTextChanged(CharSequence s, int start, int before, int count)
       {
       }

       @Override
       public void afterTextChanged(Editable s)
       {
           value.setValue(s.toString());
       }
     }

     public Observer<String> stringObserver = new Observer<String>()
     {
        @Override
		public void onChange(String value)
		{
            editText.setText(value);
		}
     };
}
